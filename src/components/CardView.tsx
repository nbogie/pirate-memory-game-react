import { animated, useSpring } from '@react-spring/web';
import { Action } from "../gameCore/action";
import { Backing, Card } from "./Card";

interface CardViewProps {
    card: Card;
    dispatch: React.Dispatch<Action>;
    isLatestFlip: boolean;
    isPreviousFlip: boolean;
}
export function CardView({ card, dispatch, isLatestFlip, isPreviousFlip }: CardViewProps): JSX.Element {
    //SVGs generated with https://svgwave.in/
    const desertWaves = <svg width="100%" height="100%" id="svg" viewBox="0 0 720 350" xmlns="http://www.w3.org/2000/svg" className="transition duration-300 ease-in-out delay-150"><path d="M 0,400 C 0,400 0,80 0,80 C 76.05128205128204,81.68717948717949 152.1025641025641,83.37435897435897 242,76 C 331.8974358974359,68.62564102564103 435.64102564102564,52.189743589743586 508,60 C 580.3589743589744,67.81025641025641 621.3333333333333,99.86666666666667 693,101 C 764.6666666666667,102.13333333333333 867.0256410256409,72.34358974358975 949,71 C 1030.9743589743591,69.65641025641025 1092.5641025641025,96.75897435897436 1171,103 C 1249.4358974358975,109.24102564102564 1344.7179487179487,94.62051282051283 1440,80 C 1440,80 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="#fcb900" fill-opacity="0.265" className="transition-all duration-300 ease-in-out delay-150 path-0"></path><path d="M 0,400 C 0,400 0,160 0,160 C 80.04102564102564,171.47692307692307 160.08205128205128,182.95384615384617 240,175 C 319.9179487179487,167.04615384615383 399.7128205128206,139.6615384615384 490,142 C 580.2871794871794,144.3384615384616 681.0666666666666,176.40000000000003 748,177 C 814.9333333333334,177.59999999999997 848.020512820513,146.73846153846154 930,143 C 1011.979487179487,139.26153846153846 1142.851282051282,162.64615384615385 1236,170 C 1329.148717948718,177.35384615384615 1384.574358974359,168.67692307692306 1440,160 C 1440,160 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="#fcb900" fill-opacity="0.4" className="transition-all duration-300 ease-in-out delay-150 path-1"></path><path d="M 0,400 C 0,400 0,240 0,240 C 66.71282051282051,249 133.42564102564103,258 203,251 C 272.574358974359,244 345.0102564102565,221.00000000000003 437,215 C 528.9897435897435,208.99999999999997 640.5333333333333,220.00000000000003 725,226 C 809.4666666666667,231.99999999999997 866.8564102564103,232.99999999999997 947,239 C 1027.1435897435897,245.00000000000003 1130.0410256410255,256 1216,257 C 1301.9589743589745,258 1370.9794871794873,249 1440,240 C 1440,240 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="#fcb900" fill-opacity="0.53" className="transition-all duration-300 ease-in-out delay-150 path-2"></path><path d="M 0,400 C 0,400 0,320 0,320 C 84.1076923076923,314.8871794871795 168.2153846153846,309.77435897435896 257,305 C 345.7846153846154,300.22564102564104 439.2461538461538,295.78974358974364 522,301 C 604.7538461538462,306.21025641025636 676.8,321.0666666666667 748,318 C 819.2,314.9333333333333 889.5538461538463,293.9435897435897 967,299 C 1044.4461538461537,304.0564102564103 1128.9846153846154,335.1589743589743 1209,343 C 1289.0153846153846,350.8410256410257 1364.5076923076922,335.42051282051284 1440,320 C 1440,320 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="#fcb900" fill-opacity="1" className="transition-all duration-300 ease-in-out delay-150 path-3"></path></svg>;
    const seaWaves = <svg width="100%" height="100%" id="svg" viewBox="0 0 720 350" xmlns="http://www.w3.org/2000/svg" className="transition duration-300 ease-in-out delay-150"><path d="M 0,400 C 0,400 0,80 0,80 C 75.82564102564103,90.33333333333334 151.65128205128207,100.66666666666667 241,96 C 330.34871794871793,91.33333333333333 433.2205128205128,71.66666666666666 505,72 C 576.7794871794872,72.33333333333334 617.4666666666667,92.66666666666667 688,92 C 758.5333333333333,91.33333333333333 858.9128205128204,69.66666666666666 944,72 C 1029.0871794871796,74.33333333333334 1098.8820512820514,100.66666666666669 1179,106 C 1259.1179487179486,111.33333333333331 1349.5589743589744,95.66666666666666 1440,80 C 1440,80 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="#0693e3" fill-opacity="0.265" className="transition-all duration-300 ease-in-out delay-150 path-0"></path><path d="M 0,400 C 0,400 0,160 0,160 C 83.16410256410259,161.17948717948718 166.32820512820518,162.35897435897436 243,158 C 319.6717948717948,153.64102564102564 389.85128205128206,143.74358974358975 463,142 C 536.148717948718,140.25641025641025 612.2666666666667,146.66666666666669 704,153 C 795.7333333333333,159.33333333333331 903.0820512820515,165.58974358974356 983,159 C 1062.9179487179485,152.41025641025644 1115.405128205128,132.97435897435898 1187,131 C 1258.594871794872,129.02564102564102 1349.2974358974361,144.5128205128205 1440,160 C 1440,160 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="#0693e3" fill-opacity="0.4" className="transition-all duration-300 ease-in-out delay-150 path-1"></path><path d="M 0,400 C 0,400 0,240 0,240 C 85.44871794871796,247.56410256410254 170.8974358974359,255.1282051282051 246,248 C 321.1025641025641,240.8717948717949 385.85897435897436,219.05128205128207 473,215 C 560.1410256410256,210.94871794871793 669.6666666666666,224.66666666666666 753,240 C 836.3333333333334,255.33333333333334 893.4743589743591,272.28205128205127 961,269 C 1028.5256410256409,265.71794871794873 1106.4358974358972,242.2051282051282 1188,234 C 1269.5641025641028,225.7948717948718 1354.7820512820513,232.8974358974359 1440,240 C 1440,240 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="#0693e3" fill-opacity="0.53" className="transition-all duration-300 ease-in-out delay-150 path-2"></path><path d="M 0,400 C 0,400 0,320 0,320 C 68.78461538461539,318.9153846153846 137.56923076923078,317.83076923076925 209,312 C 280.4307692307692,306.16923076923075 354.5076923076923,295.59230769230766 436,306 C 517.4923076923077,316.40769230769234 606.4,347.8 690,345 C 773.6,342.2 851.8923076923077,305.2076923076923 948,294 C 1044.1076923076923,282.7923076923077 1158.0307692307692,297.3692307692308 1243,306 C 1327.9692307692308,314.6307692307692 1383.9846153846154,317.3153846153846 1440,320 C 1440,320 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="#0693e3" fill-opacity="1" className="transition-all duration-300 ease-in-out delay-150 path-3"></path></svg>;
    const lavaSVG = <svg width="100%" height="100%" id="svg" viewBox="0 0 720 350" xmlns="http://www.w3.org/2000/svg" className="transition duration-300 ease-in-out delay-150"><defs><linearGradient id="gradientLava" x1="56%" y1="0%" x2="44%" y2="100%"><stop offset="5%" stop-color="#eb144c"></stop><stop offset="95%" stop-color="#fcb900"></stop></linearGradient></defs><path d="M 0,400 C 0,400 0,80 0,80 C 121.53571428571428,99.32142857142857 243.07142857142856,118.64285714285714 379,109 C 514.9285714285714,99.35714285714286 665.25,60.75 778,56 C 890.75,51.25 965.9285714285713,80.35714285714286 1070,90 C 1174.0714285714287,99.64285714285714 1307.0357142857142,89.82142857142857 1440,80 C 1440,80 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="url(#gradientLava)" fill-opacity="0.265" className="transition-all duration-300 ease-in-out delay-150 path-0"></path><defs><linearGradient id="gradientLava" x1="56%" y1="0%" x2="44%" y2="100%"><stop offset="5%" stop-color="#eb144c"></stop><stop offset="95%" stop-color="#fcb900"></stop></linearGradient></defs><path d="M 0,400 C 0,400 0,160 0,160 C 155.10714285714283,148.21428571428572 310.21428571428567,136.42857142857142 415,140 C 519.7857142857143,143.57142857142858 574.2499999999999,162.5 680,168 C 785.7500000000001,173.5 942.7857142857142,165.57142857142858 1078,162 C 1213.2142857142858,158.42857142857142 1326.607142857143,159.21428571428572 1440,160 C 1440,160 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="url(#gradientLava)" fill-opacity="0.4" className="transition-all duration-300 ease-in-out delay-150 path-1"></path><defs><linearGradient id="gradientLava" x1="56%" y1="0%" x2="44%" y2="100%"><stop offset="5%" stop-color="#eb144c"></stop><stop offset="95%" stop-color="#fcb900"></stop></linearGradient></defs><path d="M 0,400 C 0,400 0,240 0,240 C 86.21428571428572,245.60714285714286 172.42857142857144,251.21428571428572 315,244 C 457.57142857142856,236.78571428571428 656.5000000000001,216.74999999999997 782,216 C 907.4999999999999,215.25000000000003 959.5714285714287,233.7857142857143 1057,241 C 1154.4285714285713,248.2142857142857 1297.2142857142858,244.10714285714283 1440,240 C 1440,240 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="url(#gradientLava)" fill-opacity="0.53" className="transition-all duration-300 ease-in-out delay-150 path-2"></path><defs><linearGradient id="gradientLava" x1="56%" y1="0%" x2="44%" y2="100%"><stop offset="5%" stop-color="#eb144c"></stop><stop offset="95%" stop-color="#fcb900"></stop></linearGradient></defs><path d="M 0,400 C 0,400 0,320 0,320 C 82.17857142857142,326.3928571428571 164.35714285714283,332.7857142857143 308,338 C 451.64285714285717,343.2142857142857 656.7500000000001,347.24999999999994 775,344 C 893.2499999999999,340.75000000000006 924.6428571428571,330.2142857142857 1021,325 C 1117.357142857143,319.7857142857143 1278.6785714285716,319.8928571428571 1440,320 C 1440,320 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="url(#gradientLava)" fill-opacity="1" className="transition-all duration-300 ease-in-out delay-150 path-3"></path></svg>;
    const jungleSVG = <svg width="100%" height="100%" id="svg" viewBox="0 0 720 350" xmlns="http://www.w3.org/2000/svg" className="transition duration-300 ease-in-out delay-150"><defs><linearGradient id="gradientJungle" x1="4%" y1="30%" x2="96%" y2="70%"><stop offset="5%" stop-color="#7bdcb5"></stop><stop offset="95%" stop-color="#00d084"></stop></linearGradient></defs><path d="M 0,400 C 0,400 0,80 0,80 C 29.24390901192681,80.46513289000963 58.48781802385362,80.93026578001925 79,77 C 99.51218197614638,73.06973421998075 111.29263691651232,64.74406976993261 134,64 C 156.70736308348768,63.25593023006739 190.341634310097,70.0934551402503 217,76 C 243.658365689903,81.9065448597497 263.34082584309976,86.8821096690662 283,95 C 302.65917415690024,103.1178903309338 322.295062317504,114.37810618348489 348,106 C 373.704937682496,97.62189381651511 405.47892488688433,69.60546559699422 436,62 C 466.52107511311567,54.39453440300578 495.7892381349583,67.2000314285382 517,72 C 538.2107618650417,76.7999685714618 551.3641225732828,73.59440868885301 571,76 C 590.6358774267172,78.40559131114699 616.7542715719111,86.42233381604971 645,93 C 673.2457284280889,99.57766618395029 703.6187911390732,104.71625604694809 728,108 C 752.3812088609268,111.28374395305191 770.7705638717962,112.71264199615784 793,108 C 815.2294361282038,103.28735800384216 841.2989533737422,92.4331759684205 867,90 C 892.7010466262578,87.5668240315795 918.0336226332354,93.55465413016017 941,93 C 963.9663773667646,92.44534586983983 984.566556093316,85.34820751093885 1007,78 C 1029.433443906684,70.65179248906115 1053.700152993501,63.05251582608448 1078,63 C 1102.299847006499,62.94748417391552 1126.6328319326806,70.44172918472323 1150,74 C 1173.3671680673194,77.55827081527677 1195.768519275776,77.18056743502264 1223,80 C 1250.231480724224,82.81943256497736 1282.2930909642141,88.83600107518622 1304,88 C 1325.7069090357859,87.16399892481378 1337.0591168673673,79.4754282642325 1358,77 C 1378.9408831326327,74.5245717357675 1409.4704415663164,77.26228586788375 1440,80 C 1440,80 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="url(#gradientJungle)" fill-opacity="0.265" className="transition-all duration-300 ease-in-out delay-150 path-0"></path><defs><linearGradient id="gradientJungle" x1="4%" y1="30%" x2="96%" y2="70%"><stop offset="5%" stop-color="#7bdcb5"></stop><stop offset="95%" stop-color="#00d084"></stop></linearGradient></defs><path d="M 0,400 C 0,400 0,160 0,160 C 29.35486644068105,161.39131154519094 58.7097328813621,162.78262309038192 82,160 C 105.2902671186379,157.21737690961808 122.51593491523266,150.26081918366336 142,155 C 161.48406508476734,159.73918081633664 183.22652745770733,176.1741001749647 208,184 C 232.77347254229267,191.8258998250353 260.57795525393806,191.04278011647784 287,179 C 313.42204474606194,166.95721988352216 338.4616515265403,143.654779359124 362,136 C 385.5383484734597,128.345220640876 407.57543863990077,136.3381024470261 433,145 C 458.42456136009923,153.6618975529739 487.2365939138567,162.99281085277156 512,170 C 536.7634060861433,177.00718914722844 557.4781857046726,181.69065414188762 578,177 C 598.5218142953274,172.30934585811238 618.8506632674532,158.24457257967785 640,147 C 661.1493367325468,135.75542742032215 683.1191612255149,127.33105553940098 710,132 C 736.8808387744851,136.66894446059902 768.6726918304876,154.4312052627182 792,156 C 815.3273081695124,157.5687947372818 830.1900714525349,142.9441234097262 852,144 C 873.8099285474651,145.0558765902738 902.5670223593728,161.79230109837707 928,166 C 953.4329776406272,170.20769890162293 975.5418391099738,161.88667219676566 1001,164 C 1026.4581608900262,166.11332780323434 1055.2656212007323,178.6610101145602 1077,174 C 1098.7343787992677,169.3389898854398 1113.3956760870965,147.46928734499352 1139,150 C 1164.6043239129035,152.53071265500648 1201.1516744508815,179.46184050546566 1230,184 C 1258.8483255491185,188.53815949453434 1279.997626109378,170.68335063314387 1301,168 C 1322.002373890622,165.31664936685613 1342.8578211116062,177.80475696195887 1366,179 C 1389.1421788883938,180.19524303804113 1414.5710894441968,170.09762151902055 1440,160 C 1440,160 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="url(#gradientJungle)" fill-opacity="0.4" className="transition-all duration-300 ease-in-out delay-150 path-1"></path><defs><linearGradient id="gradientJungle" x1="4%" y1="30%" x2="96%" y2="70%"><stop offset="5%" stop-color="#7bdcb5"></stop><stop offset="95%" stop-color="#00d084"></stop></linearGradient></defs><path d="M 0,400 C 0,400 0,240 0,240 C 29.41107721320156,222.86409193080618 58.82215442640312,205.7281838616124 80,213 C 101.17784557359688,220.2718161383876 114.1224595075891,251.95135648435672 134,255 C 153.8775404924109,258.0486435156433 180.6880075432405,232.4663902009608 207,232 C 233.3119924567595,231.5336097990392 259.12551031944884,256.1830827118 282,265 C 304.87448968055116,273.8169172882 324.809951178964,266.8012789518393 348,257 C 371.190048821036,247.1987210481607 397.634684964695,234.6118014808427 426,238 C 454.365315035305,241.3881985191573 484.65130896225605,260.75151512479 510,263 C 535.348691037744,265.24848487521 555.7600791862808,250.38213801999748 579,248 C 602.2399208137192,245.61786198000252 628.3083742926207,255.71993279522007 654,246 C 679.6916257073793,236.28006720477993 705.0064236432366,206.73813079912233 727,210 C 748.9935763567634,213.26186920087767 767.6659311344326,249.32754400829054 789,254 C 810.3340688655674,258.67245599170946 834.3298518190326,231.95169316771563 861,226 C 887.6701481809674,220.04830683228437 917.014661589437,234.865683320847 939,238 C 960.985338410563,241.134316679153 975.6115018232189,232.58557354889638 997,228 C 1018.3884981767811,223.41442645110362 1046.5393311176865,222.7920224835674 1076,225 C 1105.4606688823135,227.2079775164326 1136.2311737060343,232.24633651683413 1160,241 C 1183.7688262939657,249.75366348316587 1200.5359740581762,262.222631449096 1221,261 C 1241.4640259418238,259.777368550904 1265.6249300612603,244.86313768678184 1291,234 C 1316.3750699387397,223.13686231321816 1342.9643056967827,216.3248178037766 1368,218 C 1393.0356943032173,219.6751821962234 1416.5178471516087,229.83759109811172 1440,240 C 1440,240 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="url(#gradientJungle)" fill-opacity="0.53" className="transition-all duration-300 ease-in-out delay-150 path-2"></path><defs><linearGradient id="gradientJungle" x1="4%" y1="30%" x2="96%" y2="70%"><stop offset="5%" stop-color="#7bdcb5"></stop><stop offset="95%" stop-color="#00d084"></stop></linearGradient></defs><path d="M 0,400 C 0,400 0,320 0,320 C 26.76203597240559,332.15890745911906 53.52407194481118,344.3178149182382 74,339 C 94.47592805518882,333.6821850817618 108.66574819316085,310.8876477861662 133,302 C 157.33425180683915,293.1123522138338 191.81293528254545,298.13159393709685 219,297 C 246.18706471745455,295.86840606290315 266.0825106766573,288.58597646544615 287,300 C 307.9174893233427,311.41402353455385 329.85702201082535,341.5245002011185 352,348 C 374.14297798917465,354.4754997988815 396.48940128004114,337.31602273008014 426,333 C 455.51059871995886,328.68397726991986 492.18537286901017,337.21140887856114 514,338 C 535.8146271309898,338.78859112143886 542.7691072439184,331.83834175567534 568,327 C 593.2308927560816,322.16165824432466 636.7381981553161,319.4352240987374 660,315 C 683.2618018446839,310.5647759012626 686.2781001348171,304.42076184937486 708,303 C 729.7218998651829,301.57923815062514 770.1494013054152,304.88172850376327 798,305 C 825.8505986945848,305.11827149623673 841.1242946435224,302.05232413557206 861,312 C 880.8757053564776,321.94767586442794 905.3534201204956,344.90897495394836 934,339 C 962.6465798795044,333.09102504605164 995.4620248744961,298.31177604863456 1017,291 C 1038.5379751255039,283.68822395136544 1048.7984803815193,303.8439208515132 1074,317 C 1099.2015196184807,330.1560791484868 1139.344053599427,336.3125405453128 1164,330 C 1188.655946400573,323.6874594546872 1197.8253052207722,304.9059169672357 1215,304 C 1232.1746947792278,303.0940830327643 1257.3547255174842,320.06379158574424 1285,325 C 1312.6452744825158,329.93620841425576 1342.7557927092903,322.83891668978737 1369,320 C 1395.2442072907097,317.16108331021263 1417.6221036453549,318.58054165510634 1440,320 C 1440,320 1440,400 1440,400 Z" stroke="none" stroke-width="0" fill="url(#gradientJungle)" fill-opacity="1" className="transition-all duration-300 ease-in-out delay-150 path-3"></path></svg>;
    const flowersSVG = <svg width="100%" height="100%" id="svg" viewBox="0 0 720 350" xmlns="http://www.w3.org/2000/svg" className="transition duration-300 ease-in-out delay-150"><path d="M 0,500 C 0,500 0,100 0,100 C 101.59999999999997,117.06666666666666 203.19999999999993,134.13333333333333 392,125 C 580.8000000000001,115.86666666666667 856.8000000000002,80.53333333333333 1046,72 C 1235.1999999999998,63.46666666666666 1337.6,81.73333333333333 1440,100 C 1440,100 1440,500 1440,500 Z" stroke="none" stroke-width="0" fill="#9900ef" fill-opacity="0.265" className="transition-all duration-300 ease-in-out delay-150 path-0"></path><path d="M 0,500 C 0,500 0,200 0,200 C 212.66666666666663,217.73333333333335 425.33333333333326,235.46666666666667 565,228 C 704.6666666666667,220.53333333333333 771.3333333333335,187.86666666666667 905,179 C 1038.6666666666665,170.13333333333333 1239.3333333333333,185.06666666666666 1440,200 C 1440,200 1440,500 1440,500 Z" stroke="none" stroke-width="0" fill="#9900ef" fill-opacity="0.4" className="transition-all duration-300 ease-in-out delay-150 path-1"></path><path d="M 0,500 C 0,500 0,300 0,300 C 202.66666666666663,305.20000000000005 405.33333333333326,310.40000000000003 539,317 C 672.6666666666667,323.59999999999997 737.3333333333334,331.6 876,329 C 1014.6666666666666,326.4 1227.3333333333333,313.2 1440,300 C 1440,300 1440,500 1440,500 Z" stroke="none" stroke-width="0" fill="#9900ef" fill-opacity="0.53" className="transition-all duration-300 ease-in-out delay-150 path-2"></path><path d="M 0,500 C 0,500 0,400 0,400 C 118.93333333333334,400.5333333333333 237.86666666666667,401.06666666666666 420,410 C 602.1333333333333,418.93333333333334 847.4666666666667,436.2666666666667 1028,436 C 1208.5333333333333,435.7333333333333 1324.2666666666667,417.8666666666667 1440,400 C 1440,400 1440,500 1440,500 Z" stroke="none" stroke-width="0" fill="#9900ef" fill-opacity="1" className="transition-all duration-300 ease-in-out delay-150 path-3"></path></svg>;

    const backgroundSVGLookup: Record<Backing, JSX.Element> = {
        "desert": desertWaves,
        "water": seaWaves,
        "flowers": flowersSVG,
        "jungle": jungleSVG,
        "lava": lavaSVG
    };
    const backgroundSVG = backgroundSVGLookup[card.backing];

    const springs = useSpring({
        transform: `perspective(600px) rotateX(${card.isFaceUp ? 0 : 180}deg)`
    });
    const facingClass = card.isFaceUp ? "faceUp" : "faceDown";
    const highlightClass = isLatestFlip ? "latest" : (isPreviousFlip ? "previous" : "");

    return (
        <animated.div
            style={{ ...springs }}
            className={`card ${card.creature} ${card.backing} ${facingClass} ${highlightClass}`}
            onClick={() => dispatch({ type: "flip", clickedCard: card })}
        >
            {card.isFaceUp ? <div className="backgroundSVG">{backgroundSVG}</div> : ""}
            {card.isFaceUp ? card.creature : ""}
        </animated.div>
    );
}

